# Project\_template

## 1. Анализ и планирование

### 1.1 Описание функциональности монолитного приложения (As-Is)

**Управление отоплением:**

- Пользователи могут удалённо управлять отоплением в доме.
- Система поддерживает получение информации о температуре.
- Управление осуществляется через сервер, который отправляет команды датчикам.
- Подключение нового устройства требует выезда специалиста.

**Мониторинг температуры:**

- Сервер запрашивает данные о температуре с датчиков.
- Данные передаются синхронно.

### 1.2 Анализ архитектуры монолитного приложения

- **Язык программирования**: Java
- **База данных**: PostgreSQL
- **Взаимодействие компонентов**: Синхронное REST API
- **Проблемы**:
  - Монолитная архитектура затрудняет масштабирование.
  - Отсутствие асинхронных взаимодействий снижает гибкость системы.
  - Устройства нельзя подключить самостоятельно.
  - Требуется выезд специалистов для подключения новых устройств.

### 1.3 Определение доменов и границы контекстов

Выделены следующие домены:

1. **Управление отоплением** — управление температурой и настройками отопления.
2. **Освещение** — включение/выключение и настройка освещения.
3. **Контроль доступа** — управление воротами и замками.
4. **Мониторинг** — получение данных с датчиков, видеонаблюдение.

### 1.4 Проблемы монолитного решения

- Низкая масштабируемость.
- Зависимость между модулями (изменение одной части влияет на другие).
- Высокие затраты на внедрение новых устройств.
- Отсутствие асинхронных коммуникаций затрудняет расширение системы.

### 1.5 Визуализация контекста системы — диаграмма C4

**Диаграмма контекста:**

[Контекстная диаграмма](./documentation/c4/asis/context.puml)

---

## 2. Проектирование микросервисной архитектуры (To-Be)

**Целевая экосистема:**

- Пользователи могут подключать устройства самостоятельно.
- Поддержка SaaS-модели.
- Гибкость для добавления новых функций.
- Подключение устройств по стандартным протоколам.

**Выделенные микросервисы:**

1. **House Service** — управление домами.
2. **Device Service** — управление устройствами.
3. **Telemetry Service** — сбор данных с датчиков.
4. **Auth Service** — аутентификация и авторизация.

**Диаграмма контейнеров:**

[Диаграмма контейнеров](./documentation/c4/tobe/container.puml)

**Диаграмма компонентов:**

[Диаграмма компонентов](./documentation/c4/tobe/component.puml)

---

## 3. Разработка ER-диаграммы

**ER-диаграмма системы:**

[ER-диаграмма](./documentation/c4/tobe/er_diagram.puml)

Ключевые сущности:

- **House** (id, userId, description)
- **Device** (id, houseId, name, serialNumber, status)
- **Telemetry** (id, deviceId, date, data)

---

## 4. Создание и документирование API

### 4.1 REST API (OpenAPI)

#### Управление домами:


[Управление домами](./documentation/api/open-api.yaml)


#### Управление устройствами:


[Управление устройствами](./documentation/api/open-api.yaml)


### 4.2 Async API (WebSockets, MQTT, Kafka)

#### Каналы взаимодействия:


[Каналы взаимодействия](./documentation/api/async-api.yaml)

- **heatingCommand** — команды для управления отоплением.
- **lighteningCommand** — команды для управления освещением.
- **gatesCommand** — команды для управления воротами.
- **telemetry** — сбор данных с устройств.

---
